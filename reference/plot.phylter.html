<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These functions take objects of class phylter as input
and display various plots summarizing the results obtained (see details)."><title>Plot phylter objects — plot.phylter • phylter</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot phylter objects — plot.phylter"><meta property="og:description" content="These functions take objects of class phylter as input
and display various plots summarizing the results obtained (see details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">phylter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.11</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/runphylter.html">1-Use of phylter</a>
    <a class="dropdown-item" href="../articles/phyltercontainer.html">2-PhylteR in a container</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/damiendevienne/phylter/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot phylter objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/damiendevienne/phylter/blob/HEAD/R/plot.phylter.R" class="external-link"><code>R/plot.phylter.R</code></a></small>
      <div class="d-none name"><code>plot.phylter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions take objects of class phylter as input
and display various plots summarizing the results obtained (see details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for phylter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="st">"all"</span>, layout <span class="op">=</span> <span class="fl">1</span>, sorted <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot2WR</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  show.missing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  transpose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clust <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotDispersion</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotRV</span><span class="op">(</span><span class="va">x</span>, what <span class="op">=</span> <span class="st">"Initial"</span>, labelnames <span class="op">=</span> <span class="cn">TRUE</span>, clust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotopti</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>The object returned by the 'phylter()' function.</p></dd>


<dt>what</dt>
<dd><p>Specifies what to plot. If "species", a barplot will show how many
genes each species is in, and what proportion of thoses were detected as outliers. 
If "genes", a barplot shows how many species contains each gene and how many of 
them has been detected as outliers. If "all" (the defaut), the two plots
described above are displayed one after the other, prompting the user to press 
ENTER to display the next one.</p></dd>


<dt>layout</dt>
<dd><p>What layout to use. Do not change if you don't know what it is.</p></dd>


<dt>sorted</dt>
<dd><p>Logical. Should bars be sorted by the number of outliers detected. Default
to TRUE</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to plot and print functions.</p></dd>


<dt>show.missing</dt>
<dd><p>Logical. Should missing data be represented on the heatmap. If TRUE (the default), white dots show were these missing entries are in both the initial and final 2WR matrices.</p></dd>


<dt>show.outliers</dt>
<dd><p>Logical. Should outliers be represented on the heatmap. If TRUE (the default), yellow dots indicate outliers on the final 2WR matrix.</p></dd>


<dt>transpose</dt>
<dd><p>Logical. If TRUE, the two matrices are piled up instaed of being displayed side by side. Default to FALSE.</p></dd>


<dt>clust</dt>
<dd><p>Logical. Should the rows or/and columns of the matrices that are plotted be reorderd
prior to plotting. Reordering is based on a hierarchical clustering. Default to FALSE. 
This is conveninent when the names of the genes are very long for instance.</p></dd>


<dt>labelnames</dt>
<dd><p>Logical. If TRUE, the names of labels are indicated on the heatmap. If FALSE they are removed. 
This is conveninent when the names of the genes are very long for instance.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The desired plots are returned. Note that you might want to call the pdf(),
 png(), jpeg(), or tiff() function first if you want to save the plot(s) to an
external file. You can also use the function <code>write.phylter(pdfreport=TRUE)</code> to write 
all possible plots in a single pdf file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<ul><li><p><code>plot(x)</code> and <code>plot.phylter(x)</code> plot the genes found in each species or species 
found in each gene as barplots, highlighting the outliers detected.</p></li>
<li><p><code>plot2WR(x)</code> plots side by side the initial and the final gene x species (unreable for large datasets) 
matrices (the 2WR matrices), highlighting missing data and detected outliers.</p></li>
<li><p><code>plotDispersion(x)</code> plots dispersion of data before and after phylter, on a 2D
space. Each dot represents a gene-species association.</p></li>
<li><p><code>plotRV(x)</code> plots the RV coefficient matrix that descibes all agains all correlations between gene matrices</p></li>
<li><p><code>plotopti(x)</code> plots the compromise matrix score at each step of the 
optimization.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">carnivora</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># perform phylter analysis</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="phylter.html">phylter</a></span><span class="op">(</span><span class="va">carnivora</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Genes:    125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Species:  53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial score: 0.86235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     28  new cells to remove -&gt; New score: 0.90272 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     18  new cells to remove -&gt; New score: 0.90833 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     16  new cells to remove -&gt; New score: 0.91501 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     18  new cells to remove -&gt; New score: 0.92561 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5  new cells to remove -&gt; New score: 0.93404 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4  new cells to remove -&gt; New score: 0.93692 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2  new cells to remove -&gt; New score: 0.93712 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  new cells to remove -&gt; New score: 0.94392 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  new cells to remove -&gt; New score: 0.94417 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1  new cells to remove -&gt; New score: 0.94426 -&gt; OK</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  =&gt; No more outliers detected  -&gt;  Checking for complete gene outliers</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  =&gt; No more outliers detected  -&gt;  STOPPING OPTIMIZATION</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of outliers detected: 94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of complete gene outliers : 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of complete species outliers : 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gain (concordance between matrices): 8.19% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loss (data filtering): 1.42% </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot for each gene the number of outlier species</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"genes"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.phylter-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># plot for each species the number genes where it is outlier</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"species"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.phylter-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the dispersion of data before and after the use of phylter</span></span></span>
<span class="r-in"><span><span class="fu">plotDispersion</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.phylter-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Damien M. de Vienne, Stéphane Dray, Théo Tricou, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

